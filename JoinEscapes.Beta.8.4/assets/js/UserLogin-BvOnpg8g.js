const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-BbGdIXXl.js","assets/js/react-vendor-9pH4USaU.js","assets/js/supabase-Cd1B4uHG.js","assets/js/utils-Dxy8Veww.js","assets/js/ui-vendor-BW9IHOa4.js","assets/index--5X5uWKa.css"])))=>i.map(i=>d[i]);
var e=(e,r,a)=>new Promise((s,t)=>{var i=e=>{try{n(a.next(e))}catch(r){t(r)}},l=e=>{try{n(a.throw(e))}catch(r){t(r)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,l);n((a=a.apply(e,r)).next())});import{_ as r}from"./supabase-Cd1B4uHG.js";import{u as a,j as s}from"./index-BbGdIXXl.js";import{u as t,r as i}from"./react-vendor-9pH4USaU.js";import{r as l,i as n}from"./inputValidator-i9iGeD-F.js";import{h as o,E as d,j as c,k as m,L as u,X as x}from"./ui-vendor-BW9IHOa4.js";import"./utils-Dxy8Veww.js";const p=()=>{const{isAuthenticated:p,loading:h,signIn:b,signUp:g,user:f}=a(),y=t(),[j,v]=i.useState(!1),[w,N]=i.useState(""),[k,z]=i.useState(""),[E,S]=i.useState(""),[C,G]=i.useState(!1),[P,_]=i.useState(""),[D,K]=i.useState(""),[V,q]=i.useState(!1),[A,F]=i.useState(!1),[H,L]=i.useState(""),[O,T]=i.useState(!1),[Y,$]=i.useState(""),[B,I]=i.useState(!1);i.useEffect(()=>{p&&!h&&f&&f.id&&y("/")},[p,h,f,y]);return h?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-white flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):p?null:A?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-white flex items-center justify-center p-4",children:s.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-6 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(o,{className:"h-8 w-8 text-green-600"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"E-posta Doğrulama"}),s.jsxs("p",{className:"text-gray-600 mb-4",children:[s.jsx("strong",{children:H})," adresine doğrulama linki gönderildi."]}),s.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Lütfen e-posta kutunuzu kontrol edin ve linke tıklayarak hesabınızı aktifleştirin."}),s.jsx("button",{onClick:()=>{F(!1),L(""),v(!1)},className:"w-full bg-primary-600 text-white py-2 px-4 rounded-lg hover:bg-primary-700 transition-colors",children:"Giriş Yap"})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-white flex items-center justify-center p-4",children:[s.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:j?"Hesap Oluştur":"Kullanıcı Girişi"}),s.jsx("p",{className:"text-gray-600",children:j?"JoinEscapes ailesine katılın":"Giriş yaparak kişisel deneyiminizi özelleştirin ve güncel keşiflerden ilk siz haberdar olun."})]}),P&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:P}),D&&s.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm",children:D}),s.jsxs("form",{onSubmit:r=>e(null,null,function*(){r.preventDefault(),_(""),K(""),q(!0);try{const e=l.checkAuthEndpoint(j?"signup":"signin");if(!e.allowed)return void _(e.message);const r=n.validateEmail(w);if(!r.isValid)return void _("E-posta hatası: "+r.errors.join(", "));const a=n.validatePassword(k);if(!a.isValid)return void _("Şifre hatası: "+a.errors.join(", "));if(j){if(k!==E)return void _("Şifreler eşleşmiyor");const{data:e,error:r}=yield g(w,k,"user");r?_("Kayıt işlemi başarısız: "+r.message):(null==e?void 0:e.needsEmailConfirmation)?(F(!0),L(w),N(""),z(""),S(""),K("Kayıt başarılı! E-posta adresinize gönderilen doğrulama linkine tıklayarak hesabınızı aktifleştirin.")):K("Kayıt başarılı! Giriş yapabilirsiniz.")}else{const{data:e,error:r}=yield b(w,k);r?_("Giriş başarısız: "+r.message):K("Giriş başarılı! Yönlendiriliyorsunuz...")}}catch(e){_("Bir hata oluştu: "+e.message)}finally{q(!1)}}),className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-posta"}),s.jsx("input",{type:"email",value:w,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"E-posta adresinizi girin",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Şifre"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:C?"text":"password",value:k,onChange:e=>z(e.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Şifrenizi girin",required:!0}),s.jsx("button",{type:"button",onClick:()=>G(!C),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:C?s.jsx(d,{className:"h-4 w-4"}):s.jsx(c,{className:"h-4 w-4"})})]})]}),j&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Şifre (Tekrar)"}),s.jsx("input",{type:"password",value:E,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Şifrenizi tekrar girin",required:!0})]}),s.jsx("button",{type:"submit",disabled:V,className:"w-full bg-primary-600 text-white py-2 px-4 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:V?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):j?s.jsxs(s.Fragment,{children:[s.jsx(m,{className:"h-4 w-4 mr-2"})," Hesap Oluştur"]}):s.jsxs(s.Fragment,{children:[s.jsx(u,{className:"h-4 w-4 mr-2"})," Giriş Yap"]})}),s.jsxs("div",{className:"text-center space-y-2",children:[!j&&s.jsx("div",{children:s.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),T(!0)},className:"text-sm text-gray-600 hover:text-primary-600 cursor-pointer",children:"Şifremi unuttum"})}),s.jsx("div",{children:s.jsx("button",{type:"button",onClick:()=>v(!j),className:"text-sm text-primary-600 hover:text-primary-700",children:j?"Zaten hesabın var mı? Giriş yap":"Hesabın yok mu? Kayıt ol"})})]})]})]}),O&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md mx-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Şifremi Unuttum"}),s.jsx("button",{onClick:()=>{T(!1),$(""),_(""),K("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(x,{className:"h-5 w-5"})})]}),s.jsx("p",{className:"text-gray-600 mb-4",children:"E-posta adresinizi girin, size şifre sıfırlama linki gönderelim."}),s.jsxs("form",{onSubmit:a=>e(null,null,function*(){a.preventDefault(),_(""),K(""),I(!0);try{const a=n.validateEmail(Y);if(!a.isValid)return void _("E-posta hatası: "+a.errors.join(", "));const{supabase:s}=yield r(()=>e(null,null,function*(){const{supabase:e}=yield import("./index-BbGdIXXl.js").then(e=>e.b);return{supabase:e}}),__vite__mapDeps([0,1,2,3,4,5])),{error:t}=yield s.auth.resetPasswordForEmail(Y,{redirectTo:"localhost"===window.location.hostname?`${window.location.protocol}//${window.location.host}/kullanici-girisi?reset=true`:`${window.location.origin}/kullanici-girisi?reset=true`});t?_("Şifre sıfırlama hatası: "+t.message):(K("Şifre sıfırlama linki e-posta adresinize gönderildi."),T(!1),$(""))}catch(s){_("Bir hata oluştu: "+s.message)}finally{I(!1)}}),children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),s.jsx("input",{type:"email",value:Y,onChange:e=>$(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"E-posta adresinizi girin",required:!0})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>{T(!1),$(""),_(""),K("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",disabled:B,children:"İptal"}),s.jsx("button",{type:"submit",className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50",disabled:B,children:B?"Gönderiliyor...":"Gönder"})]})]})]})})]})};export{p as default};
